var te=Object.defineProperty,ne=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var M=(e,l,o)=>l in e?te(e,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[l]=o,u=(e,l)=>{for(var o in l||(l={}))W.call(l,o)&&M(e,o,l[o]);if(k)for(var o of k(l))A.call(l,o)&&M(e,o,l[o]);return e},g=(e,l)=>ne(e,ae(l));var F=(e,l)=>{var o={};for(var a in e)W.call(e,a)&&l.indexOf(a)<0&&(o[a]=e[a]);if(e!=null&&k)for(var a of k(e))l.indexOf(a)<0&&A.call(e,a)&&(o[a]=e[a]);return o};import{r as j,b as c,j as t,P as h,s as U,R as re,c as le,k as oe,l as V,n as B,o as se,i as G,d as H,q as ie,h as q,t as ce,v as de,w as x,e as ue,x as pe,y as he,z as fe,A as ge,u as ve,C as me,D as N,B as w,E as ye,G as be}from"./index.4c085f80.js";import{r as ke}from"./logs.c6249493.js";import{S as C}from"./Select.fcc21c26.js";import{R as we}from"./rotate-cw.f6a28e9d.js";function Ce(e,l){if(e==null)return{};var o=_e(e,l),a,n;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],!(l.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,a)||(o[a]=e[a]))}return o}function _e(e,l){if(e==null)return{};var o={},a=Object.keys(e),n,r;for(r=0;r<a.length;r++)n=a[r],!(l.indexOf(n)>=0)&&(o[n]=e[n]);return o}var I=j.exports.forwardRef(function(e,l){var o=e.color,a=o===void 0?"currentColor":o,n=e.size,r=n===void 0?24:n,d=Ce(e,["color","size"]);return c("svg",g(u({ref:l,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},d),{children:[t("polyline",{points:"8 17 12 21 16 17"}),t("line",{x1:"12",y1:"12",x2:"12",y2:"21"}),t("path",{d:"M20.88 18.09A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.29"})]}))});I.propTypes={color:h.string,size:h.oneOfType([h.string,h.number])};I.displayName="DownloadCloud";var Oe=I;function Se(e,l){if(e==null)return{};var o=xe(e,l),a,n;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],!(l.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,a)||(o[a]=e[a]))}return o}function xe(e,l){if(e==null)return{};var o={},a=Object.keys(e),n,r;for(r=0;r<a.length;r++)n=a[r],!(l.indexOf(n)>=0)&&(o[n]=e[n]);return o}var z=j.exports.forwardRef(function(e,l){var o=e.color,a=o===void 0?"currentColor":o,n=e.size,r=n===void 0?24:n,d=Se(e,["color","size"]);return c("svg",g(u({ref:l,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},d),{children:[t("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t("polyline",{points:"16 17 21 12 16 7"}),t("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}))});z.propTypes={color:h.string,size:h.oneOfType([h.string,h.number])};z.displayName="LogOut";var Ne=z;function Pe(e,l){if(e==null)return{};var o=je(e,l),a,n;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],!(l.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,a)||(o[a]=e[a]))}return o}function je(e,l){if(e==null)return{};var o={},a=Object.keys(e),n,r;for(r=0;r<a.length;r++)n=a[r],!(l.indexOf(n)>=0)&&(o[n]=e[n]);return o}var L=j.exports.forwardRef(function(e,l){var o=e.color,a=o===void 0?"currentColor":o,n=e.size,r=n===void 0?24:n,d=Pe(e,["color","size"]);return c("svg",g(u({ref:l,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},d),{children:[t("polyline",{points:"3 6 5 6 21 6"}),t("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),t("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),t("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}))});L.propTypes={color:h.string,size:h.oneOfType([h.string,h.number])};L.displayName="Trash2";var Ie=L;const{useState:ze,useRef:Le,useEffect:Te,useCallback:$e}=re;function Re(e){return t("input",u({className:U.input},e))}function Ee(o){var a=o,{value:e}=a,l=F(a,["value"]);const[n,r]=ze(e),d=Le(e);Te(()=>{d.current!==e&&r(e),d.current=e},[e]);const v=$e(_=>r(_.target.value),[r]);return t("input",u({className:U.input,value:n,onChange:v},l))}const De="_root_1tdl3_1",Me="_section_1tdl3_2",We="_wrapSwitch_1tdl3_26",Ae="_sep_1tdl3_32",Fe="_label_1tdl3_45";var i={root:De,section:Me,wrapSwitch:We,sep:Ae,label:Fe};const Ve="_fieldset_1ghjp_1",Be="_input_1ghjp_9",Ue="_cnt_1ghjp_9";var P={fieldset:Ve,input:Be,cnt:Ue};function Ge({OptionComponent:e,optionPropsList:l,selectedIndex:o,onChange:a}){const n=le("visually-hidden",P.input),r=d=>{a(d.target.value)};return t("fieldset",{className:P.fieldset,children:l.map((d,v)=>c("label",{children:[t("input",{type:"radio",checked:o===v,name:"selection",value:v,"aria-labelledby":"traffic chart type "+v,onChange:r,className:n}),t("div",{className:P.cnt,children:t(e,u({},d))})]},v))})}const{useMemo:He}=G,qe={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},J=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],Je=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],Ke=J;function Qe({id:e}){const l=oe.read(),o=He(()=>({labels:Ke,datasets:[g(u(u({},V),B[e].up),{data:J}),g(u(u({},V),B[e].down),{data:Je})]}),[e]),a="chart-"+e;return se(l.Chart,a,o,null,qe),t("div",{style:{width:100,padding:5},children:t("canvas",{id:a})})}const{useEffect:K,useState:Xe,useCallback:y,useRef:Ye}=G,Ze=[{id:0},{id:1},{id:2},{id:3}],et=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],tt=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"},{key:"mitm-port",label:"MITM Port"}],nt=[["zh","\u4E2D\u6587"],["en","English"]],at=[["direct","Direct"],["rule","Rule"],["script","Script"],["global","Global"]],rt=[["gVisor","gVisor"],["System","System"]],lt=e=>({configs:ie(e),apiConfig:q(e)}),ot=e=>({selectedChartStyleIndex:ye(e),latencyTestUrl:be(e),apiConfig:q(e)}),st=H(ot)(ct);var gt=H(lt)(it);function it({dispatch:e,configs:l,apiConfig:o}){return K(()=>{e(ce(o))},[e,o]),t(st,{configs:l})}function ct({dispatch:e,configs:l,selectedChartStyleIndex:o,latencyTestUrl:a,apiConfig:n}){const[r,d]=Xe(l),v=Ye(l);K(()=>{v.current!==l&&d(l),v.current=l},[l]);const _=y(()=>{e(de("apiConfig"))},[e]),O=y((s,p)=>{d(g(u({},r),{[s]:p}))},[r]),T=y((s,p)=>{const m=g(u({},r.tun),{[s]:p});d(g(u({},r),{tun:u({},m)}))},[r]),b=y(({name:s,value:p})=>{switch(s){case"mode":case"log-level":case"allow-lan":case"sniffing":O(s,p),e(x(n,{[s]:p})),s==="log-level"&&ke(g(u({},n),{logLevel:p}));break;case"mitm-port":case"redir-port":case"socks-port":case"mixed-port":case"port":if(p!==""){const m=parseInt(p,10);if(m<0||m>65535)return}O(s,p);break;case"enable":case"stack":T(s,p),e(x(n,{tun:{[s]:p}})).then(()=>{ue(n)});break;default:return}},[n,e,O,T]),Q=y(s=>b(s.target),[b]),{selectChartStyleIndex:X,updateAppConfig:$}=pe(),R=y(s=>{const p=s.target,{name:m,value:D}=p;switch(m){case"port":case"socks-port":case"mixed-port":case"redir-port":case"mitm-port":{const S=parseInt(D,10);if(S<0||S>65535)return;e(x(n,{[m]:S}));break}case"latencyTestUrl":{$(m,D);break}default:throw new Error(`unknown input name ${m}`)}},[n,e,$]),Y=y(()=>{e(he(n))},[n,e]),Z=y(()=>{e(fe(n))},[n,e]),ee=y(()=>{e(ge(n))},[n,e]),{t:f,i18n:E}=ve();return c("div",{children:[t(me,{title:f("Config")}),c("div",{className:i.root,children:[tt.map(s=>r[s.key]!==void 0?c("div",{children:[t("div",{className:i.label,children:s.label}),t(Re,{name:s.key,value:r[s.key],onChange:Q,onBlur:R})]},s.key):null),c("div",{children:[t("div",{className:i.label,children:"Mode"}),t(C,{options:at,selected:r.mode,onChange:s=>b({name:"mode",value:s.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:"Log Level"}),t(C,{options:et,selected:r["log-level"],onChange:s=>b({name:"log-level",value:s.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:f("allow_lan")}),t("div",{className:i.wrapSwitch,children:t(N,{name:"allow-lan",checked:r["allow-lan"],onChange:s=>b({name:"allow-lan",value:s})})})]}),c("div",{children:[t("div",{className:i.label,children:f("tls_sniffing")}),t("div",{className:i.wrapSwitch,children:t(N,{name:"sniffing",checked:r.sniffing,onChange:s=>b({name:"sniffing",value:s})})})]})]}),t("div",{className:i.sep,children:t("div",{})}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:f("enable_tun_device")}),t("div",{className:i.wrapSwitch,children:t(N,{checked:r.tun.enable,onChange:s=>b({name:"enable",value:s})})})]}),c("div",{children:[t("div",{className:i.label,children:"TUN IP Stack"}),t(C,{options:rt,selected:r.tun.stack,onChange:s=>b({name:"stack",value:s.target.value})})]})]}),t("div",{className:i.sep,children:t("div",{})}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:"Reload"}),t(w,{start:t(we,{size:16}),label:f("reload_config_file"),onClick:Y})]}),c("div",{children:[t("div",{className:i.label,children:"GEO Databases"}),t(w,{start:t(Oe,{size:16}),label:f("update_geo_databases_file"),onClick:Z})]}),c("div",{children:[t("div",{className:i.label,children:"FakeIP"}),t(w,{start:t(Ie,{size:16}),label:f("flush_fake_ip_pool"),onClick:ee})]})]}),t("div",{className:i.sep,children:t("div",{})}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:f("latency_test_url")}),t(Ee,{name:"latencyTestUrl",type:"text",value:a,onBlur:R})]}),c("div",{children:[t("div",{className:i.label,children:f("lang")}),t("div",{children:t(C,{options:nt,selected:E.language,onChange:s=>E.changeLanguage(s.target.value)})})]}),c("div",{children:[t("div",{className:i.label,children:f("chart_style")}),t(Ge,{OptionComponent:Qe,optionPropsList:Ze,selectedIndex:o,onChange:X})]}),c("div",{children:[t("div",{className:i.label,children:"Action"}),t(w,{start:t(Ne,{size:16}),label:"Switch backend",onClick:_})]})]})]})}export{gt as default};
